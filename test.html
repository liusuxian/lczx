<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>绿城咨询</title>
</head>
<body>
<form id="login" action="http://127.0.0.1/login" method="get">
    <span>绿城咨询</span>
    <br><br>
    <input style="width: 240px; height: 30px; border-radius: 5px;" type="text" name="passport" value="sadmin">
    <br><br>
    <input style="width: 240px; height: 30px; border-radius: 5px;" type="password" name="password" value="sadmin">
    <br><br>
    <input style="width: 115px; height: 30px; border-radius: 5px;" type="text" name="verifyCode" value="">
    <input id="captchaKey" style="display: none;" type="text" name="verifyKey" value="">
    <img id="captchaImg" src=""
         style="border-style: none; cursor: pointer; vertical-align: middle; width: 120px; height: 40px"
         onclick="changeCaptchaImg()">
    <br><br>
    <input style="width: 240px; height: 30px;" type="submit" value="登录">
</form>
<br><br>
<form enctype="multipart/form-data" action="http://127.0.0.1/upload/test" method="post">
    <input type="file" name="upload-test"/>
    <input type="submit" value="upload" style="background-color: #7ED321;width: 76px;height: 36px;color: #FFFFFF"/>
</form>
<script type="text/javascript">
    window.onload = function () {
        let request = new XMLHttpRequest()
        request.onload = function () {
            if (request.status === 200) {
                getCaptchaImg(request.responseText)
            }
        }
        request.open("GET", "http://127.0.0.1/captcha/img")
        request.send(null)
    }

    /*json字符串转对象*/
    function stringToObject(json) {
        return eval("(" + json + ")")
    }

    /*获取验证码图片*/
    function getCaptchaImg(responseText) {
        let response = stringToObject(responseText)
        if (response.code === 0) {
            document.getElementById("captchaImg").setAttribute("src", response.data.verifyCode)
            document.getElementById("captchaKey").setAttribute("value", response.data.verifyKey)
        }
    }

    /*改变验证码图片*/
    function changeCaptchaImg() {
        let request = new XMLHttpRequest()
        request.onload = function () {
            if (request.status === 200) {
                getCaptchaImg(request.responseText)
            }
        }
        request.open("GET", "http://127.0.0.1/captcha/img")
        request.send(null)
    }
</script>
<style>
</style>
</body>
</html>